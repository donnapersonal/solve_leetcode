# 168.Excel Sheet Column Title

## LeetCode 题目链接

[168.Excel 表列名称](https://leetcode.cn/problems/excel-sheet-column-title/)

## 题目大意

给你一个整数 `columnNumber`，返回它在 `Excel` 表中相对应的列名称

例如：

A -> 1
B -> 2
C -> 3
...
Z -> 26
AA -> 27
AB -> 28 
...

```js
Example 1:
Input: columnNumber = 1
Output: "A"

Example 2:
Input: columnNumber = 28
Output: "AB"

Example 3:
Input: columnNumber = 701
Output: "ZY"
```

限制:
- 1 <= columnNumber <= 2^31 - 1

## 解题

本质问题：`26` 进制字母表示法（无 `0` 位）

与普通进制不同的是，`Excel` 的列号表示是：
- 用 `'A' ~ 'Z'` 表示 `1 ~ 26`
- 是一种不带 `0` 的 `26` 进制
- 每一位从 `1` 到 `26`，而不是 `0` 到 `25`

思路
- 使用模拟进制转换的方式，不过有两个关键点，差异点：
  - 普通进制是从 `0~25`（即 `digit = columnNumber % 26`）
  - `Excel` 是从 `1~26`，因此在每轮需要：先执行 `columnNumber -= 1` 再取余数 `columnNumber % 26`

```js
var convertToTitle = function(columnNumber) {
    let res = '';

    while (columnNumber > 0) {
        columnNumber--;  // shift to 0-based
        const remainder = columnNumber % 26;
        res = String.fromCharCode(65 + remainder) + res;
        columnNumber = Math.floor(columnNumber / 26);
    }

    return res;
};
```
```python
class Solution:
    def convertToTitle(self, columnNumber: int) -> str:
        res = []

        while columnNumber > 0:
            columnNumber -= 1  
            remainder = columnNumber % 26
            res.append(chr(ord('A') + remainder))
            columnNumber //= 26

        return ''.join(reversed(res))
```

- 时间复杂度：`O(log₍₂₆₎columnNumber)`
  - 时间复杂度即为将 `columnNumber` 转换成 `26` 进制的位数，每次除以 `26`，最多处理 `log₍₂₆₎columnNumber` 位
- 空间复杂度：`O(1)`，返回值不计入空间复杂度
  - 注意，在某些语言（如 `Java、C#、JavaScript`）中字符串是不可变的，因此需额外的 `O(log₍₂₆₎columnNumber)` 的空间来存储返回值的中间结果
  - 但忽略这一复杂度分析，因为这依赖于语言的细节